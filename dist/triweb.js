/*!
 * 
 * triweb.js v0.0.1a - a part of the Triweb Platform
 *
 * See https://triweb.com/ and https://github.com/triweb/triweb/ for more details.
 *
 * Copyright (c) 2024, Shore Labs Zbigniew Zemła - triweb.com
 *
 * All rights reserved.
 * Use of this software is subject to the licensing terms published by the copyright holder.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
 * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
 * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
 * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Triweb=t():e.Triweb=t()}(this,(()=>(()=>{var __webpack_modules__={"./src/triweb.js.coffee":function(e,t,n){var r=n("./src/triweb.js.coffee");(function(){n("./src/triweb/helpers/index.js.coffee"),n("./src/triweb/adapters/index.js.coffee"),n("./src/triweb/resolvers/index.js.coffee"),n("./src/triweb/logger.js.coffee"),n("./src/triweb/error.js.coffee"),"undefined"!=typeof window&&n("./src/triweb/container/index.js.coffee"),r.logger||(r.logger=new r.Logger),r.logger.logLevel="debug",r.identity=null,r.MANIFEST=n("./src/manifest.json"),r.resolver=new r.Resolvers.Cloudflare,"undefined"!=typeof window&&(window.Triweb||(window.Triweb=r)),e.exports=r}).call(this)},"./src/triweb/adapters/browser.js.coffee":function(e,t,n){var r=n("./src/triweb.js.coffee");(function(){r.Adapters.Browser=class{constructor(){this.fetch=function(...e){return window.fetch(...e)},this.WebSocket=window.WebSocket,this.textEncoder=new window.TextEncoder,this.textDecoder=new window.TextDecoder}async fetchText(e,t){var n;return n=await window.fetch(e,{headers:new Headers(t)}),await n.text()}},"undefined"!=typeof window&&(r.adapter=new r.Adapters.Browser)}).call(this)},"./src/triweb/adapters/index.js.coffee":function(e,t,n){var r=n("./src/triweb.js.coffee");(function(){r.Adapters={},n("./src/triweb/adapters/browser.js.coffee"),n("./src/triweb/adapters/node.js.coffee")}).call(this)},"./src/triweb/adapters/node.js.coffee":function(__unused_webpack_module,__unused_webpack_exports,__webpack_require__){var Triweb=__webpack_require__("./src/triweb.js.coffee");(function(){Triweb.Adapters.Node=function(){var REQUIRED_PACKAGES;class Node{constructor(){var i,len,nodeRequire,pkg;for(nodeRequire=eval("require"),i=0,len=REQUIRED_PACKAGES.length;i<len;i++)pkg=REQUIRED_PACKAGES[i],nodeRequire(pkg);this.WebSocket=nodeRequire("ws"),this.textEncoder=new(nodeRequire("util").TextEncoder),this.textDecoder=new(nodeRequire("util").TextDecoder)}async fetchText(e,t={}){var n;return this._nodeFetch||(this._nodeFetch=nodeRequire("node-fetch")),n=await this._nodeFetch(e,{headers:new this._nodeFetch.Headers(t)}),await n.text()}}return REQUIRED_PACKAGES=["util"],Node}.call(this),"undefined"==typeof window&&(Triweb.adapter=new Triweb.Adapters.Node)}).call(this)},"./src/triweb/container/app_assets.js.coffee":function(e,t,n){var r=n("./src/triweb.js.coffee");(function(){r.Container.AppAssets=class{constructor(e){this.get=this.get.bind(this),this.list=this.list.bind(this),this.cacheKey=e}async get(e){var t,n;return t=await caches.open(this.cacheKey),(n=await t.match(e))?await n.blob():null}async list(){var e;return e=await caches.open(this.cacheKey),(await e.keys()).map((function(e){return new URL(e.url)})).filter((function(e){return e.host===window.location.host})).map((function(e){return e.pathname}))}async delete(e){var t;return t=await caches.open(this.cacheKey),await t.delete(e)}async purge(){return await caches.delete(this.cacheKey)}async validate(e){var t,n,r,s,i;for(t=e.assets||[],r=await caches.open(this.cacheKey),s=0,i=t.length;s<i;s++)if(n=t[s],!await r.match("/"+n))return!1;return!0}static async test(){var e,t,n,r,s;s=!1;try{t="_triweb-test",e=await caches.open(t),n="/_triweb-test.txt",await e.put(n,new Response("aa")),s=(r=await e.match(n))&&200===r.status&&"aa"===await r.text(),await caches.delete(t)}catch(e){e,s=!1}return s}}}).call(this)},"./src/triweb/container/base.js.coffee":function(e,t,n){var r=n("./src/triweb.js.coffee");(function(){r.Container=function(){var e;class t{static reloadArgs(){return t.resolveDomainConfig().then(t._storeDomainConfig).then((()=>t.args=t.domainConfig))}static async resolveDomainConfig(e=window.location.hostname,n=3){var s,i;return!(n<0)&&(i=await r.resolver.resolveConfig("_triweb."+e),Object.keys(i).length>0?i:(s=(await r.resolver.resolve(e,"CNAME"))[0])?(r.logger.debug("Configuration not found under _triweb."+e+" but "+e+" is a CNAME for "+s),t.resolveDomainConfig(s.replace(/\.$/,""),n-1)):(r.logger.debug("Configuration not found under _triweb."+e),!1))}static _storeDomainConfig(e){return r.Container.domainConfig=e,window.localStorage.setItem("_triweb[domainConfig]",JSON.stringify(e)),r.Container.domainConfig}static _restoreDomainConfig(){return r.Container.domainConfig=JSON.parse(window.localStorage.getItem("_triweb[domainConfig]")||"{}"),r.Container.domainConfig}static async _applyDomainConfig(n=r.Container.domainConfig){var s,i,o,a,c,l,f,u,p;for(p=null,o=0,l=n.length;o<l;o++)"app"===(i=n[o]).key&&null===p?p=[i.value,i.options]:"app"===i.key&&(r.Logger.warn("Multiple applications selected for installation"),p=!1);if(a=await t.listApps(),!p&&Object.keys(a).length<=1)throw new e("unconfigured");if(p&&"*"!==p[0])if(Object.keys(a).length<=1)await r.Container.installSelf(),await t.installApp(p[0]);else if(Object.values(a).find((e=>e.manifestUrl===t._expandManifestUrl(p[0]))))await r.Container.installSelf(),await t.installApp(p[0],{update:!0});else for(c=0,f=(u=Object.values(a)).length;c<f;c++)"..."!==(s=u[c]).id&&await s.assets.purge();else await r.Container.installSelf();return window.location="/"}static _expandManifestUrl(e){var t;try{return t="..."===e?window.location.origin:"https://apps.triweb.com/",(e=new URL(String(e).trim(),t).toString()).match(/\.json$/)||(e.match(/\/$/)||(e+="/"),e+="manifest.json"),e}catch(e){return e,null}}static async installSelf(){var e,n;return e=await caches.open("_triweb[...]"),(n=await e.match("/manifest.json"))&&JSON.parse(await n.text()).version===r.MANIFEST.version||(await t._unregisterServiceWorkers(),await t.installApp("...",{force:!0})),await t._registerServiceWorker()}static async listApps(e={}){var t,n,s,i,o,a,c,l,f,u,p,h,d;for(d={},o=0,a=(u=(await caches.keys()).map((function(e){return e.match(/^_triweb\[([a-z_][a-z0-9-_.\/]+|\.\.\.)\]$/)})).filter((function(e){return!!e}))).length;o<a;o++){[n,t]=u[o];try{if((s={id:t}).assets=new r.Container.AppAssets(n),!(l=await s.assets.get("/manifest.json")))continue;f=await l.text(),c=JSON.parse(f),s.manifest=c,s.manifestUrl=null!=(p=s.manifest.metadata)?p.manifest_url:void 0,s.version=s.manifest.version,s.priority=null!=(h=s.manifest.metadata)?h.priority:void 0,d[t]=s}catch(e){i=e,r.logger.error(`Unable to read application details for ${t} from ${n}`,i)}}return d}static init(){return t.resolveDomainConfig().then(t._storeDomainConfig).catch(t._restoreDomainConfig).then((()=>t.args=t.domainConfig))}static async autorun(e=null,n={}){var s;try{return await t._autorun(e,n)}catch(e){throw s=e,r.logger.error(s),t.trigger("error",s),s}}static async _autorun(n=null,s={}){var i,o,a,c,l,f,u;if(window.location.host.match(/^\d+\.\d+\.\d+\.\d+(:\d+)?$/)||window.location.host.match(/^\[?(?:[A-F0-9]{1,4}:){7}[A-F0-9]{1,4}(\]:\d+)?$/i))throw new e("unsupported-location");if("https:"!==window.location.protocol&&"localhost"!==window.location.hostname)return window.location.protocol="https:";if((f=await t._checkBrowserSupport())instanceof r.Container.Error)throw f;for(await t.init(),o=0,a=(l=r.Container.domainConfig).length;o<a;o++)"meta-title"===(i=l[o]).key?(document.title=i.value,(u=document.createElement("title")).innerText=i.value,document.head.appendChild(u)):"meta-description"===i.key&&((c=document.createElement("meta")).setAttribute("name","description"),c.setAttribute("content",i.value),document.head.appendChild(c));return await t._applyDomainConfig()}static async _checkBrowserSupport(){try{await r.Container.AppAssets.test()}catch(t){return new e("unsupported-browser",{err:t})}try{navigator.serviceWorker.register}catch(t){return new e("unsupported-browser",{err:t})}return!0}static spawnJob(e,t=null){var n;return n=r.Container.jobs.slice(-1)[0],t||(t=function(){return!0}),r.Container.jobs.push(e),n?n.perform().finally((()=>e.perform().catch(t))):e.perform().catch(t),e}static installApp(e,n={}){return r.logger.info("Triweb.Container.installApp",e,n),t.spawnJob(new r.Container.Jobs.AppInstall(e,n))}static uninstallApp(e,n={}){return r.logger.info("Triweb.Container.uninstallApp",e,n),t.spawnJob(new r.Container.Jobs.AppUninstall(e,n))}static async _registerServiceWorker(e="/.../triweb-container-sw.js"){return await navigator.serviceWorker.register(e,{scope:"/"}).catch(r.logger.error).then((function(e){return r.logger.info("Service worker registered",e)}))}static async _unregisterServiceWorkers(){var e,t,n,r,s,i,o;for(i=[],e=0,t=(s=await navigator.serviceWorker.getRegistrations()).length;e<t;e++)(o=null!=(n=(r=s[e]).active||r.waiting)?n.scriptURL:void 0)&&new URL(o).pathname.match(/^\/\.\.\.\//)?i.push(await r.unregister()):i.push(void 0);return i}}return t.APP_MANIFEST_SCHEMA={id:{type:"string",match:/^([a-z_][a-z0-9-_.\/]+)|(\.\.\.)$/},name:{type:"string"},version:{type:"string",match:/./},base_url:{type:"string",match:r.Helpers.Resources.SSL_URL_REGEXP,optional:!0},assets:{type:"object",instance:Array},"assets.*":{type:"string",match:/^([a-z0-9._-]+\/?)+$/i},start:{type:"string",match:/^[\/A-Z0-9-_.]$/i,optional:!0},"**":{}},t.Error=e=class extends r.Error{constructor(e,t={}){super(e,t),Object.assign(this.messages,{"unsupported-location":["Location is not a domain name",function(e){return""}],"unsupported-browser":["Your web browser is not supported",function(e){return`Your web browser is missing some features that are required for this application to work. Please exit the incognito mode, use a modern web browser, or update your web browser to the latest version. ${e.err}`}],unconfigured:["No application selected for installation",function(e){return`Please publish DNS TXT record for _triweb.${window.location.hostname} domain that will include information about desired application e.g., _triweb.${window.location.hostname} TXT "app https://.../manifest.json"`}]})}},t.domainConfig=[],t.args=[],t.jobs=[],t}.call(this),Object.assign(r.Container,r.Helpers.EventExtension),e.exports=r.Container}).call(this)},"./src/triweb/container/index.js.coffee":function(e,t,n){var r=n("./src/triweb.js.coffee");(function(){r.Container=n("./src/triweb/container/base.js.coffee"),n("./src/triweb/container/app_assets.js.coffee"),n("./src/triweb/container/job.js.coffee"),n("./src/triweb/container/jobs/index.js.coffee"),n("./src/triweb/container/ui/index.js.coffee"),e.exports=r.Container}).call(this)},"./src/triweb/container/job.js.coffee":function(e,t,n){var r=n("./src/triweb.js.coffee");(function(){r.Container.Job=function(){class e{constructor(){this.perform=this.perform.bind(this),this.then=this.then.bind(this),this._setProgress=this._setProgress.bind(this),this._setMilestone=this._setMilestone.bind(this),this._setState=this._setState.bind(this),this._dispatchEvent=this._dispatchEvent.bind(this),this.id=r.Container.Job._sequence++,this.type=this.constructor.type,this.state="pending",this.promise=new Promise(((e,t)=>(this._resolve=e,this._reject=t))),this.milestones=[],this.currentMilestone=null,this.progress=0,Object.assign(this,r.Helpers.EventExtension)}perform(){return this._performPromise||(this._performPromise=new Promise(((e,t)=>{var n;try{return this._setState("running"),this._perform().then((t=>(this._setState("finished",t),e(this.result),this._resolve(this.result)))).catch((e=>(this._setState("failed",e),t(e),this._reject(e))))}catch(e){return n=e,this._setState("failed",n),t(n),this._reject(n)}})))}then(e,t){return this.promise.then(e,t)}_setProgress(e){var t;return t=e,this.progress=e,this._dispatchEvent("progressChange",{job:this,prevProgress:t,progress:e})}_setMilestone(e){var t;return r.logger.info("Triweb.Container.Job",this.id,"reached milestone",e),this.currentMilestone&&this.milestones.push(this.currentMilestone),t=this.currentMilestone,this.currentMilestone=e,this._dispatchEvent("milestoneChange",{job:this,prevMilestone:t,milestone:e})}_setState(e,t=null){var n;return r.logger.info("Triweb.Container.Job job",this.id,"state changed from",this.state,"to",e),n=this.state,this.state=e,this.result=t,this._dispatchEvent("stateChange",{job:this,prevState:n,state:e})}_dispatchEvent(e,t={}){return t.job=this,t.type=e,this.trigger(e,t),this.constructor.trigger(e,t)}}return e._sequence=0,e}.call(this),Object.assign(r.Container.Job,r.Helpers.EventExtension)}).call(this)},"./src/triweb/container/jobs/app_install.js.coffee":function(e,t,n){var r=n("./src/triweb.js.coffee");(function(){var e,t=function(e,t){if(!(e instanceof t))throw new Error("Bound instance method accessed before binding")};e=r.Container.Jobs.AppInstall=function(){var n;class s extends r.Container.Job{constructor(e,t){var n,r;super(),this._perform=this._perform.bind(this),this._fetchManifests=this._fetchManifests.bind(this),this._fetchAssets=this._fetchAssets.bind(this),this._installAssets=this._installAssets.bind(this),this.manifestUrl=e,this.opts=t,(n=this.opts).force||(n.force=!1),(r=this.opts).update||(r.update=!1),this.appManifest=null,this.appIconUrl=null,this._seenDeps=[],this._seenApps={},this._totalAssetsCount=1,this._fetchedAssetsCount=0,this._priorityOffset=this.opts.priority}async _perform(){var n,r,s,i,o,a,c,l;if(t(this,e),this._setMilestone("Downloading manifest files"),0===(l=await this._fetchManifests(!1,this.manifestUrl,this.opts)).length)return!1;for(this._setMilestone("Downloading asset files"),s={},this._totalAssetsCount=l.map((function(e){return Object.keys(e.assets||{}).length})).reduce((function(e,t){return e+t}),0)||1,o=0,a=l.length;o<a;o++)c=l[o],i=await this._fetchAssets(c),s[c.id]={manifest:c,assets:i};for(r in this._setMilestone("Installing application"),s)n=s[r],await this._installAssets(n.manifest,n.assets);return this.appManifest.id}async _fetchManifests(s,i,o){var a,c,l,f,u,p,h,d,w,b,m,g,v,_,y,x;if(t(this,e),this._setMilestone("Downloading manifest file from "+i),!(i=r.Container._expandManifestUrl(i)))throw new n("manifestUrlInvalid",{manifestUrl:i});try{if(l=new Date,200!==(f=await fetch(i,{method:"GET",cache:"no-store"})).status)throw new n("manifestDownloadError")}catch(e){if(d=e,d=new n("manifestDownloadError",{manifestUrl:i,httpStatus:(null!=f?f.status:void 0)+" "+(null!=f?f.statusText:void 0),err:d}),o.update&&!o.force)return r.logger.warn(d),d;throw d}this._setMilestone("Parsing manifest file");try{c=await f.json()}catch(e){if(d=e,d=new n("manifestParsingError"),o.update&&!o.force)return r.logger.warn(d),d;throw d}try{r.Helpers.Validation.validateSchema(c,r.Container.APP_MANIFEST_SCHEMA)}catch(e){if(d=new n("manifestValidationError",{message:(d=e).message}),o.update&&!o.force)return r.logger.warn(d),d;throw d}if(s||(this.appManifest=c,c.icons&&Array.isArray(c.icons)&&c.icons.length>0&&(w=(null!=(_=this.appManifest.icons.find((function(e){return"any"===e.sizes})))?_.src:void 0)||this.appManifest.icons[0].src,this.appIconUrl=new URL(w,i).toString())),this._setMilestone("Verifying if application is not already installed"),a=c.id,(v=(b=await r.Container.listApps())[a])&&!o.force){if(o.update||s)return[];throw new n("alreadyInstalled",{appId:a})}if(o.update&&v&&v.version===c.version)return this._setMilestone("Application is already up to date"),[];for(u in this._priorityOffset||(void 0!==this.opts.priority?this._priorityOffset=this.opts.priority:(m=Math.max.apply(null,Object.values(b).map((function(e){return e.priority})))||0,this._priorityOffset=100*Math.floor((m+100)/100))),s||(c.start_url=window.location.origin),c.metadata={manifest_url:i,fetched_at:l,primary:!s,priority:this._priorityOffset+10*s},x=[c],this._setMilestone("Resolving dependencies"),y=c.dependencies||{})if(h=y[u],!b[u]&&!this._seenApps[u]){if(this._seenDeps.indexOf(u)>=0)throw new n("circularDependency",{appId:a,depId:u});if(this._seenDeps.push(u),g=new URL(i,window.location),h=new URL(h,g),!(p=await this._fetchManifests(s+1,h.toString(),{},{update:!0}))||!p[0])throw new n("missingDependency",{appId:a,depId:u});if(u!==p[0].id)throw new n("invalidDependency",{appId:a,depId:u});this._seenApps[u]=!0,this._seenDeps.pop(),x=x.concat(p)}return x}async _fetchAssets(r){var s,i,o,a,c,l,f,u;if(t(this,e),[],s={},Array.isArray(r.assets))for(c=0,f=(u=r.assets).length;c<f;c++)s[i=u[c]]={src:i};else r.assets&&(s=r.assets);for(o=Object.entries(s),a=[],l=0;l<=4;++l)a.push(new Promise((async(e,t)=>{var s,a,c,l,f,u,p,h,d,w,b,m,g;for(m=[];i=o.shift();){if([a,s]=i,!("manifest.json"===a||a.match(/^\.\.\.\//)&&"..."!==r.id)){try{if((p=new Headers).append("pragma","no-cache"),p.append("cache-control","no-cache"),f=r.base_url?r.base_url+s.src:new URL(s.src,r.metadata.manifest_url).toString(),200!==(b=await fetch(f,{method:"GET",cache:"no-store"})).status)throw`HTTP ${b.status} ${b.statusText}`;for(c=b.clone(),g=new Headers({}),h=0,d=(w=["Content-Length","Content-Encoding"]).length;h<d;h++)u=w[h],b.headers.has(u)&&g.append(u,b.headers.get(u));b=new Response(c.body,{status:c.status,statusText:c.statusText,headers:g})}catch(e){return l=e,t(new n("assetDownloadError",{assetUrl:s.src,message:l}))}m.push(["/"+a,b])}this._fetchedAssetsCount+=1,this._setProgress(Math.ceil(this._fetchedAssetsCount/this._totalAssetsCount*100))}return e(m)})));return(await Promise.all(a)).flat()}async _installAssets(n,r){var s,i,o,a,c;for(t(this,e),i=`_triweb[${n.id}]`,await caches.delete(i),s=await caches.open(i),o=0,c=r.length;o<c;o++)a=r[o],await s.put(a[0],a[1]);return await s.put("/manifest.json",new Response(JSON.stringify(n)))}}return s.type="Triweb.Container.Jobs.AppInstall",s.Error=n=class extends r.Container.Error{constructor(e,t={}){super(e,t),Object.assign(this.messages,{manifestUrlInvalid:["The URL of manifest file is not valid",function(e){return`The provided URL of application manifest.json file is invalid or incomplete.\nPlease pass a complete secure URL ending with /manifest.json as a parameter.\nGot: ${e.manifestUrl}`}],manifestDownloadError:["The application manifest file could not be downloaded",function(e){return`Could not download the application manifest file from ${e.manifestUrl}.\nPlease make sure the URL is accessible and 'Access-Control-Allow-Origin:*' header is present on the requested resource.\nHTTP Status: ${e.httpStatus}`}],manifestParsingError:["The application manifest file is not valid",function(e){return"The application manifest file should be a JSON document"}],manifestValidationError:["The application manifest file structure is not valid",function(e){return`The application manifest file's schema is invalid.\n${e.message}`}],assetDownloadError:["Download error",function(e){return`Could not download application asset from ${e.assetUrl}.\nPlease make sure 'Access-Control-Allow-Origin:*' header is present on the requested resource.\n${e.message}`}],"manifest.empty_assets":["The application manifest does not list any assets",function(e){return`Application ${e.manifest.id} manifest does not list any assets ${e.manifest}`}],alreadyInstalled:["Application is already installed",function(e){return`An application ${e.appId} is already present in this container. Please uninstall it first, or force re-installation.`}],circularDependency:["Circular dependency detected",function(e){return`Circular dependency detected while installing ${e.appId}.`}],missingDependency:["Dependency not found",function(e){return`Application '${e.appId}' requires '${e.depId}' to be installed but its manifest file could not be fetched.`}],invalidDependency:["Dependency application ID mismatch",function(e){return`Application ${e.appId} dependency ${e.depId} ID is different than declared.`}]})}},s}.call(this)}).call(this)},"./src/triweb/container/jobs/app_uninstall.js.coffee":function(e,t,n){var r=n("./src/triweb.js.coffee");(function(){var e;e=r.Container.Jobs.AppUninstall=function(){var t;class n extends r.Container.Job{constructor(e,t){super(),this._perform=this._perform.bind(this),this.appId=e,this.opts=t}async _perform(){var n,s,i,o,a,c,l,f,u,p,h,d,w,b,m,g,v;if(function(e,t){if(!(e instanceof t))throw new Error("Bound instance method accessed before binding")}(this,e),this._setMilestone("Finding application to uninstall"),i=await r.Container.listApps(),!(s=Object.values(i).find((e=>e.id===this.appId))))return!1;for(this.appManifest=s.manifest,this._setMilestone("Checking for dependency conflicts"),w=[this.appId],b=0;w.length!==b;){for(b=w.length,a=0,u=w.length;a<u;a++)d=w[a],w=w.concat(Object.values(i).filter((e=>Object.keys(e.manifest.dependencies||{}).indexOf(d)>=0)).map((function(e){return e.id})));w=w.filter((function(e,t,n){return n.indexOf(e)===t}))}if(!this.opts.force&&!this.opts.prune&&1!==b)throw new t("dependencyConflict",{appId:this.appId,conflictingApps:w});if(this.opts.prune||(w=[]),g=[],this.opts.recursive){for(g=[this.appId],v=0,this._setMilestone("Checking for apps for recursive deletion");g.length!==v;){for(v=g.length,c=0,p=g.length;c<p;c++)m=g[c],g=g.concat(Object.keys(i[m].manifest.dependencies||{}));g=g.filter((function(e,t,n){return n.indexOf(e)===t}))}for(v=g.length+1;g.length!==v;)v=g.length,f=Object.keys(i).filter((function(e){return g.indexOf(e)<0&&w.indexOf(e)<0})),g=g.filter((e=>!f.some((t=>Object.keys(i[t].manifest.dependencies||{}).indexOf(e)>=0))))}for(o=[this.appId,w,g].flat().filter((function(e,t,n){return n.indexOf(e)===t})),this._setMilestone("Preparing to uninstall "+o.length+" apps."),l=0,h=o.length;l<h;l++)n=o[l],this._setMilestone("Uninstalling "+n),await i[n].assets.purge();return!0}}return n.type="Triweb.Container.Jobs.AppUninstall",n.Error=t=class extends r.Container.Error{constructor(e,t={}){super(e,t),Object.assign(this.messages,{dependencyConflict:["This app is required by another installed app",function(e){return`Uninstallation failed because the ${e.appId} app is required by ${e.conflictingApps.length-1} other installed applications.`}]})}},n}.call(this)}).call(this)},"./src/triweb/container/jobs/index.js.coffee":function(e,t,n){var r=n("./src/triweb.js.coffee");(function(){var e;(e=r.Container).Jobs||(e.Jobs={}),n("./src/triweb/container/jobs/app_install.js.coffee"),n("./src/triweb/container/jobs/app_uninstall.js.coffee")}).call(this)},"./src/triweb/container/ui/base.js.coffee":function(e,t,n){var r=n("./src/triweb.js.coffee");(function(){var t,s=function(e,t){if(!(e instanceof t))throw new Error("Bound instance method accessed before binding")};t=r.Container.Ui=class extends HTMLElement{constructor(){var e,t;super(),this.render=this.render.bind(this),this._bindEvents=this._bindEvents.bind(this),this._bindEvents(),this.attachShadow({mode:"open"}),e=n("./src/triweb/container/ui/views/layout.html.eco"),r.Helpers.Resources.innerHTML(this.shadowRoot,e()),t=this.shadowRoot.querySelector("main"),this._el=t}render(e,i={}){var o,a,c;if(s(this,t),!this._renderState||"container_error"!==this._renderState.templateName)return this._renderState={templateName:e,templateVars:i},c=n("./src/triweb/container/ui/views sync recursive ^\\.\\/.*\\.html\\.eco$")(`./${e}.html.eco`),o=Object.assign({},i),r.Helpers.Resources.innerHTML(this._el,c(o)),null!=(a=this.shadowRoot.querySelector("[autofocus]"))?a.focus():void 0}_bindEvents(){var e,n;return s(this,t),e={AppInstall:"app_install_job"},n=(t,n)=>{var r;return r=e[n.job.type.replace("Triweb.Container.Jobs.","")],this.render(r,{job:n.job})},r.Container.Job.on(null,n),r.Container.on("error",(e=>e instanceof r.Container.Error&&"unsupportedLocation"===e.code?this.render("relay_welcome"):this.render("container_error",{error:e})))}},customElements.get("triweb-container-ui")||customElements.define("triweb-container-ui",r.Container.Ui),e.exports=r.Container.Ui}).call(this)},"./src/triweb/container/ui/index.js.coffee":function(e,t,n){var r=n("./src/triweb.js.coffee");(function(){r.Container.Ui=n("./src/triweb/container/ui/base.js.coffee"),e.exports=r.Container.Ui}).call(this)},"./src/triweb/error.js.coffee":function(e,t,n){var r=n("./src/triweb.js.coffee");(function(){r.Error=class{constructor(e,t={}){this.title=this.title.bind(this),this.message=this.message.bind(this),this.code=e,this.details=t,this.messages={}}title(){var e;return null!=(e=this.messages[this.code])?e[0]:void 0}message(){var e;return null!=(e=this.messages[this.code])&&"function"==typeof e[1]?e[1](this.details):void 0}}}).call(this)},"./src/triweb/helpers/array_extension.js.coffee":function(e,t,n){var r=n("./src/triweb.js.coffee");(function(){r.Helpers||(r.Helpers={}),r.Helpers.ArrayExtension={removeValue:function(e){var t;for(t=0;t<this.length;)this[t]===e?this.splice(t,1):t++;return this}}}).call(this)},"./src/triweb/helpers/crypto.js.coffee":function(e,t,n){var r=n("./src/triweb.js.coffee");(function(){r.Helpers||(r.Helpers={}),r.Helpers.Crypto={getRandomNumber:function(e=8){var t,n,r,s;for(r=new Uint8Array(e),crypto.getRandomValues(r),s=0,t=0,n=r.length;t<n;t++)s=s<<8|r[t];return s},generateECDHKey:function(){return crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey","deriveBits"])}}}).call(this)},"./src/triweb/helpers/encoding.js.coffee":function(e,t,n){var r=n("./src/triweb.js.coffee");(function(){r.Helpers||(r.Helpers={}),r.Helpers.Encoding={arrayBufferToString:function(e){var t,n,r,s,i;for(i="",r=0,s=(t=new Uint8Array(e)).length;r<s;r++)n=t[r],i+=String.fromCharCode(n);return i},arrayBufferToBase64:e=>{var t,n,r,s,i;for(i="",r=0,s=(t=new Uint8Array(e)).length;r<s;r++)n=t[r],i+=String.fromCharCode(n);return btoa(i)},arrayBufferToBase64Url:function(e){return this.arrayBufferToBase64(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")},base64ToUint8:e=>Uint8Array.from(atob(e),(function(e){return e.charCodeAt(0)})),stringToArrayBuffer:function(e){return(new TextEncoder).encode(e).buffer}}}).call(this)},"./src/triweb/helpers/event_extension.js.coffee":function(e,t,n){var r=n("./src/triweb.js.coffee");(function(){r.Helpers||(r.Helpers={}),r.Helpers.EventExtension={trigger:function(e,...t){return this._listeners||(this._listeners={}),(this._listeners[e]||[]).forEach((function(e,n){return e(...t)})),(this._listeners.null||[]).forEach((function(n,r){return n(e,...t)}))},on:function(e,t){var n;return this._listeners||(this._listeners={}),((n=this._listeners)[e]||(n[e]=[])).push(t)},off:function(e,t){var n,r,s,i,o;for(this._listeners||(this._listeners={}),(n=this._listeners)[e]||(n[e]=[]),o=[],r=s=i=this._listeners[e].length;i<=0?s<=0:s>=0;r=i<=0?++s:--s)this._listeners[e][r]===t||void 0===t?o.push(this._listeners[e].splice(r,1)):o.push(void 0);return o}}}).call(this)},"./src/triweb/helpers/flags.js.coffee":function(e,t,n){var r=n("./src/triweb.js.coffee");(function(){r.Helpers||(r.Helpers={}),r.Helpers.Flags=class{static set(e,t,n){return n?e|1<<t:e&~(1<<t)}static get(e,t){return e&1<<t}static encode(e,t){var n,r,s,i,o;for(o=0,r=n=0,s=t.length;n<s;r=++n)(i=t[r])&&(o=this.set(o,t.length-r-1,e[i]));return o}static decode(e,t){var n,r,s,i;for(i={},r=n=0,s=t.length;n<s;r=++n)i[t[r]]=this.get(e,r);return i}}}).call(this)},"./src/triweb/helpers/index.js.coffee":function(e,t,n){var r=n("./src/triweb.js.coffee");(function(){r.Helpers={},n("./src/triweb/helpers/event_extension.js.coffee"),n("./src/triweb/helpers/state_extension.js.coffee"),n("./src/triweb/helpers/message_extension.js.coffee"),n("./src/triweb/helpers/array_extension.js.coffee"),n("./src/triweb/helpers/resources.js.coffee"),n("./src/triweb/helpers/validation.js.coffee"),n("./src/triweb/helpers/flags.js.coffee"),n("./src/triweb/helpers/crypto.js.coffee"),n("./src/triweb/helpers/sequence.js.coffee"),n("./src/triweb/helpers/encoding.js.coffee")}).call(this)},"./src/triweb/helpers/message_extension.js.coffee":function(e,t,n){var r=n("./src/triweb.js.coffee");(function(){r.Helpers||(r.Helpers={}),r.Helpers.MessageExtension={call:function(e,t={},n=null,r=this.relay.config.answerTimeout){return this.send(e,t,n,r)},send:function(e,t={},n=null,r=!1){return"number"!=typeof e?this._sendQuery(e,t,n,r):this._sendAnswer(e,t,n)},_sendQuery:function(e,t={},n=null,r=this.relay.config.answerTimeout){return this._send([this._seq+=1,e,t],n),!r||new Promise(((t,n)=>{if(this._answerPromises[this._seq]=[t,n],"number"==typeof r)return(t=>setTimeout((()=>{var n;return null!=(n=this._answerPromises[t])&&n[1](`Timed out while waiting for answer on ${t}: ${e}`),delete this._answerPromises[t]}),r))(this._seq)}))},_sendAnswer:function(e,t={},n=null){return this._send([e,null,t],n)}}}).call(this)},"./src/triweb/helpers/resources.js.coffee":function(e,t,n){var r=n("./src/triweb.js.coffee");(function(){r.Helpers||(r.Helpers={}),r.Helpers.Resources=class e{static loadScript(e,t={}){return new Promise((function(n,r){var s,i,o,a;for(o in i=document.getElementsByTagName("head")[0],(s=document.createElement("script")).src=e,t)a=t[o],s.setAttribute(o,a);return s.onload=n,i.appendChild(s)}))}static loadStylesheet(e,t={}){return new Promise((function(n,r){var s,i,o,a;for(o in i=document.getElementsByTagName("head")[0],(s=document.createElement("link")).href=e,s.rel="stylesheet",t)a=t[o],s.setAttribute(o,a);return s.onload=n,i.appendChild(s)}))}static async loadText(e,t={}){var n;return n=await fetch(e),await n.text()}static async loadBinary(e,t={}){var n;return n=await fetch(e),await n.arrayBuffer()}static async fetchJSON(e,t={},n=null){var r;return r=await fetch(e,{method:t.method||"GET",headers:{"Content-Type":"application/json"},body:n?JSON.stringify(n):null}),await r.json()}static load(t){var n,r,s,i,o,a;if(t instanceof Array){for(o={},n=0,r=t.length;n<r;n++)o[a=t[n]]={};t=o}for(a in i=[],t)s=t[a],a.match(/\.js$/)&&i.push(e.loadScript(a,s)),a.match(/\.css$/)&&i.push(e.loadStylesheet(a,s));return Promise.all(i)}static async innerHTML(e,t){var n,r,s,i,o,a,c,l,f,u;for(e.innerHTML=t,f=[],n=0,r=(a=e.querySelectorAll("script")).length;n<r;n++){i=a[n],s=document.createElement("script"),Array.from(i.attributes).forEach((function(e){return s.setAttribute(e.name,e.value)})),s.appendChild(document.createTextNode(i.innerHTML)),l=null,c=null,u=null,o=new Promise((function(e,t){return l=e,c=function(t){return e()}})),s.src?(s.onload=l,s.onerror=c,u=setTimeout((function(){return c(`Timeout exceeded while waiting for ${s.src} to finish loading.`)}),1e3)):l(),i.parentNode.replaceChild(s,i);try{await o,f.push(clearTimeout(u))}catch(e){e,f.push(!0)}}return f}}}).call(this)},"./src/triweb/helpers/sequence.js.coffee":function(e,t,n){var r=n("./src/triweb.js.coffee");(function(){r.Helpers.Sequence=class e{constructor(){this.next=this.next.bind(this)}static next(){return e.last||(e.last=0),e.last+=1}static uuid(t){return t?(t^crypto.getRandomValues(new Uint8Array(1))[0]%16>>t/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e.uuid)}next(){return this.last||(this.last=0),this.last+=1}}}).call(this)},"./src/triweb/helpers/state_extension.js.coffee":function(e,t,n){var r=n("./src/triweb.js.coffee");(function(){r.Helpers||(r.Helpers={}),r.Helpers.StateExtension={for:function(e,t,n){var r;return r=t,Object.defineProperty(e,"state",{get:function(){return r},set:t=>{var s,i;if(t!==r)return n&&null!=n&&null!=(i=n[r])&&i.indexOf(t),s=r,r=t,"function"==typeof e.trigger?e.trigger("change:state",{previousValue:s,value:t}):void 0}})}}}).call(this)},"./src/triweb/helpers/validation.js.coffee":function(e,t,n){var r=n("./src/triweb.js.coffee");(function(){r.Helpers||(r.Helpers={}),r.Helpers.Validation=function(){class e{static validateSchema(t,n,s={prefix:"",validatedKeys:[],unknownKeys:[]}){var i,o,a,c,l,f;for(o in t){for(c in a=t[o],i=!1,n)if(l=n[c],s.prefix+o===c||s.prefix+"*"===c||"**"===c){if(l.type&&typeof a!==l.type)throw new r.Error(0,`Expected ${s.prefix+o} to be of ${l.type} type.`);if(l.match&&!String(a).match(l.match))throw new r.Error(0,`Key ${s.prefix+o} has invalid value ${JSON.stringify(a)}.`);if(l.instance&&!(a instanceof l.instance))throw new r.Error(0,`Expected ${s.prefix+o} to be an instance of ${l.instance}.`);i=!0,s.validatedKeys.push(c)}i||s.unknownKeys.push(s.prefix+o),i&&"object"==typeof a&&e.validateSchema(a,n,{prefix:s.prefix+o+".",validatedKeys:s.validatedKeys,unknownKeys:s.unknownKeys})}if(""===s.prefix){if(f=Object.keys(n).filter((function(e){return!n[e].optional&&-1===s.validatedKeys.indexOf(e)})),f.length>0)throw new r.Error(0,`Following keys are required but missing: ${f.join(", ")}.`);if(s.unknownKeys.length>0)throw new r.Error(0,`Following excess keys appear in the object: ${s.unknownKeys.join(", ")}.`);return!0}}}return e.SSL_URL_REGEXP=/^((http:\/\/localhost\/)|(https:\/\/))/,e}.call(this)}).call(this)},"./src/triweb/logger.js.coffee":function(e,t,n){var r=n("./src/triweb.js.coffee");(function(){r.Logger=class{constructor(e=null){this.debug=this.debug.bind(this),this.info=this.info.bind(this),this.warn=this.warn.bind(this),this.error=this.error.bind(this),this.output=e,"undefined"!=typeof window&&window.console&&(this.output||(this.output=window.console)),this.logLevel="warn",this.prefix="[triweb]"}debug(...e){var t;if(["debug","info"].indexOf(this.logLevel)>=0)return null!=(t=this.output)?t.info(this.prefix,"[debug]",...e):void 0}info(...e){var t;if(["debug","info"].indexOf(this.logLevel)>=0)return null!=(t=this.output)?t.info(this.prefix,"[info]",...e):void 0}warn(...e){var t;if(["debug","info","warn"].indexOf(this.logLevel)>=0)return null!=(t=this.output)?t.warn(this.prefix,"[warn]",...e):void 0}error(...e){var t;if(["debug","info","warn","error"].indexOf(this.logLevel)>=0)return null!=(t=this.output)?t.error(this.prefix,"[error]",...e):void 0}}}).call(this)},"./src/triweb/resolvers/base.js.coffee":function(e,t,n){var r=n("./src/triweb.js.coffee");(function(){r.Resolvers.Base=class{constructor(){this.resolveConfig=this.resolveConfig.bind(this)}async resolveConfig(e){var t,n,r;return r=await this.resolve(e,"TXT"),n=[],r?(t=/^([\w_\-\[\].@]+)=([\S]+)/,r.forEach((function(e){var r,s,i,o,a;if(e.match(/^([\w\[\]\-\.]+)\s+(.+)$/)){for(s={key:(o=e.split(" ")).shift(),value:"",options:{}},r="@",!1;a=o.shift();)(i=a.match(t))?(r=i[1],s.options[r]=decodeURIComponent(i[2])):s.options[r]=(s.options[r]?s.options[r]+" ":"")+decodeURIComponent(a);return s.value=s.options["@"],delete s.options["@"],n.push(s)}})),n):n}}}).call(this)},"./src/triweb/resolvers/cloudflare.js.coffee":function(e,t,n){var r=n("./src/triweb.js.coffee");(function(){r.Resolvers.Cloudflare=class extends r.Resolvers.DnsJson{constructor(e={}){e.normalizeTxtRecords=!0,super("https://cloudflare-dns.com/dns-query",e)}}}).call(this)},"./src/triweb/resolvers/dns_json.js.coffee":function(e,t,n){var s=n("./src/triweb.js.coffee");(function(){var e;e=s.Resolvers.DnsJson=class extends s.Resolvers.Base{constructor(e,t={}){super(),this.resolve=this.resolve.bind(this),this.url=e,this.options=t}resolve(t,n,s={}){return function(e,t){if(!(e instanceof t))throw new Error("Bound instance method accessed before binding")}(this,e),void 0===s.retries&&(s.retries=this.options.retries||0),void 0===s.retryDelay&&(s.retryDelay=this.options.retryDelay||150),new Promise(((e,i)=>{var o,a;for(a=`${this.url}?name=${encodeURIComponent(t)}&type=${encodeURIComponent(n)}`,o="abcdefghijklmnopqrstuwxyz",a+="&random_padding=";a.length<100;)a+=o[Math.floor(25*Math.random())];for(;a.length>100&&150!==a.length;)a+=o[Math.floor(25*Math.random())];for(;a.length>150&&a.length<250;)a+=o[Math.floor(25*Math.random())];return fetch(a,{headers:new Headers({Accept:"application/dns-json"})}).then((e=>e.text())).then((async o=>{var a,c,l,f,u,p;if(3===(l=JSON.parse(o)).Status)return e([]);if(0!==l.Status)return s.retries<=0?i():(s.retries-=1,s.retryDelay&&await new Promise(r((()=>setTimeout(r,s.retryDelay)))),this.resolve(t,n,s).then(e,i));for(p=[],c=0,f=(u=l.Answer||[]).length;c<f;c++)16===(a=u[c]).type&&this.options.normalizeTxtRecords&&a.data.length>2&&'"'===a.data[0]&&'"'===a.data[a.data.length-1]&&(a.data=a.data.replaceAll('"',"")),"TXT"===n&&16!==a.type||p.push(a.data);return e(p)})).catch((r=>s.retries<=0?i(r):(s.retries-=1,this.resolve(t,n,s).then(e,i))))}))}}}).call(this)},"./src/triweb/resolvers/google.js.coffee":function(e,t,n){var r=n("./src/triweb.js.coffee");(function(){r.Resolvers.Google=class extends r.Resolvers.DnsJson{constructor(e={}){super("https://dns.google/resolve",e)}}}).call(this)},"./src/triweb/resolvers/index.js.coffee":function(e,t,n){var r=n("./src/triweb.js.coffee");(function(){r.Resolvers={},n("./src/triweb/resolvers/base.js.coffee"),n("./src/triweb/resolvers/dns_json.js.coffee"),n("./src/triweb/resolvers/cloudflare.js.coffee"),n("./src/triweb/resolvers/google.js.coffee")}).call(this)},"./src/triweb/container/ui/views/app_install_job.html.eco":e=>{e.exports=function(e){e||(e={});var t=[],n=function(e){return e&&e.ecoSafe?e:void 0!==e&&null!=e?s(e):""},r=e.safe,s=e.escape;return e.safe=function(e){if(e&&e.ecoSafe)return e;void 0!==e&&null!=e||(e="");var t=new String(e);return t.ecoSafe=!0,t},s||(s=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e;t.push('<style>\n  ._name { font-size:0.8em; }\n  ._spinner { color:gray; }\n  ._progress { width:100px; height:5px; margin-top:1.75em; }\n</style>\n\n<div class="_icon" title="'),t.push(n((null!=(e=this.job.appManifest)?e.name:void 0)||this.job.manifestUrl)),t.push('">\n  '),this.job.appIconUrl?(t.push('\n    <img src="'),t.push(n(this.job.appIconUrl)),t.push('" referrerpolicy="no-referrer" crossorigin="anonymous" alt=""/>\n  ')):t.push('    \n    <div class="spinner _spinner"></div>\n  '),t.push('\n</div>\n\n<div class="progress _progress" title="'),t.push(n(this.job.currentMilestone)),t.push('">\n  <div class="progress-bar" role="progressbar" style="width: '),t.push(n(this.job.progress)),t.push('%" aria-valuenow="'),t.push(n(this.job.progress)),t.push('" aria-valuemin="0" aria-valuemax="100"></div>\n</div>\n\n<div style="font-size:0.8em;">\n\x3c!--Installing, please wait ...--\x3e\n'),t.push("\n"),t.push("\n"),t.push("\n"),t.push("\n</div>\n")}).call(this)}.call(e),e.safe=r,e.escape=s,t.join("")}},"./src/triweb/container/ui/views/container_error.html.eco":e=>{e.exports=function(e){e||(e={});var t=[],n=function(e){return e&&e.ecoSafe?e:void 0!==e&&null!=e?s(e):""},r=e.safe,s=e.escape;return e.safe=function(e){if(e&&e.ecoSafe)return e;void 0!==e&&null!=e||(e="");var t=new String(e);return t.ecoSafe=!0,t},s||(s=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){"unsupported-location"===this.error.code?t.push('\n  <h3>Welcome to <a href="https://triweb.com/">triweb</a></h3>\n\n'):this.error.code?(t.push('\n  <span style="margin:2em;font-size:2em;">•́︵•̀</span>\n  <h3>An error has occurred</h3>\n\n  <p>'),t.push(n(this.error.code)),t.push("</p>\n  <p>"),t.push(n(this.error.title())),t.push('</p>\n  <p style="max-width:500px;font-size:0.8em;">'),t.push(n(this.error.message())),t.push("</p>\n\n")):(t.push("\n  <h3>An error has occurred</h3>\n\n  <p>"),t.push(n(this.error)),t.push("</p>\n\n")),t.push("\n")}).call(this)}.call(e),e.safe=r,e.escape=s,t.join("")}},"./src/triweb/container/ui/views/layout.html.eco":e=>{e.exports=function(e){e||(e={});var t=[],n=e.safe,r=e.escape;return e.safe=function(e){if(e&&e.ecoSafe)return e;void 0!==e&&null!=e||(e="");var t=new String(e);return t.ecoSafe=!0,t},r||(r=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<style>\n  * { font-family:system-ui, sans-serif; }\n\n  :host { display:block; width:100%; height:100%;}\n  :host > * { height:100%; background:#f7f7f7; }\n  \n  #wrapper { display: flex; flex-direction:column; }\n\n  header { height:60px; background-color:transparent; border-bottom:none; font-size:15px; padding:0 50px; display:flex; font-size:17px; align-items:center; color:#444; font-size:0.85em; }\n  main { flex:auto; display:flex; display:flex; flex-direction:column; justify-content:center; align-items:center; margin-top:-50vh; padding:50px; }\n  footer { height:60px; position:fixed; bottom:0; font-size:1em; width:100%; }\n\n  ._copyright { position:absolute; bottom:10px; right:10px; color:gray; font-family:\'Open Sans\', sans-serif; font-weight:500; font-size:12px; text-decoration:none !important; }\n  ._copyright:hover { color:black; }\n\n  h1 { font-size:35px; margin:0 0 1em 0; }\n  h1 small { color:#888; font-size:0.5em; }\n  main a { text-decoration:none; }\n  a:hover { text-decoration:underline; }\n\n  .alert { text-align:center; padding:1em; background:#ff4136; width:100%; box-sizing:border-box; font-family:\'Open Sans\'; color:white; line-height:1.5em; position:absolute; border-bottom:2px solid #555; }\n  .alert ._close { position:absolute; right:0; top:0; border-left:1px solid #ccc; height:100%; vertical-align:middle; width:100px; cursor:pointer; }\n  .alert ._close i { position:absolute; top:calc(50% - 18px); left:calc(50% - 5px); font-size:24px; font-style:normal; }\n\n  /* Based on bootstrap spinner */\n  .spinner { display:inline-block; width:1rem; height:1rem; border:0.15em solid; border-right-color:transparent; border-radius:50%; animation:.75s linear infinite spinner; }\n  @keyframes spinner {\n    to { transform: rotate(360deg) }\n  }\n\n  .progress { display: flex;\n    height: 1rem;\n    overflow: hidden;\n    font-size: .75rem;\n    background-color: #e9ecef;\n    border-radius: 0.25rem; }\n\n  .progress-bar {\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    color: #fff;\n    text-align: center;\n    background-color: #007bff;\n    transition: width .6s ease;\n  }\n  \n  /* Based on bootstrap button */\n  .btn {\n    display:inline-block; font-weight:400; line-height:1.5; color:#212529;\n    text-align:center; text-decoration:none; vertical-align:middle;\n    cursor:pointer; -webkit-user-select:none; -moz-user-select:none; user-select:none;\n    background-color: transparent; border: 1px solid transparent;\n    padding: 6px 1.5rem; font-size: 20px; border-radius: 0.25rem;\n    transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;\n  }\n\n  .btn-small { font-size:1rem; }\n\n  @media (prefers-reduced-motion: reduce) {\n    .btn {\n      transition: none;\n    }\n  }\n  .btn:hover {\n    color: #212529;\n  }\n  .w32-btn-check:focus + .btn, .btn:focus {\n    outline: 0;\n    box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);\n  }\n  .btn:disabled, .btn.disabled, fieldset:disabled .btn {\n    pointer-events: none;\n    opacity: 0.65;\n  }\n\n  .btn-primary {\n    color: #fff;\n    background-color: #4b8dce;\n    border-color: #0d6efd;\n  }\n  .btn-primary:hover {\n    color: #fff;\n    background-color: #0062cc;\n    border-color: #005cbf;\n    text-decoration:none;\n  }\n\n  .btn-outline {\n    border:1px solid #555;\n  }\n\n  .btn-outline:hover {\n    background:#eee; text-decoration:none;\n  }\n\n  .btn-left {\n    margin-left:-24px;\n  }\n\n  .modal { position:fixed; top:0; left:0; z-index:100; width:100%; height:auto; overflow-x:hidden; overflow-y:auto; outline:0; }\n  .modal-body { max-width:1024px; margin:2em auto; background-color:white; position:relative; border-radius:0.5em; }\n  .modal-backdrop { background-color:black; position:fixed; top:0; left:0; width:100vw; height:100vh; opacity:0.5; }\n\n  .modal-header { border-bottom:1px solid #eee; margin:1.5em 0; display:flex; align-items:center; font-weight:bold; font-size:1.2em; }\n  .modal-close { position:absolute; top:1em; right:1em; text-decoration:none; }\n\n  .modal-main { margin:2em; }\n\n  .modal-footer { padding:2em; border-top:1px solid #eee; }\n\n</style>\n\n<div id="wrapper">\n\n  <header></header>\n\n  <main></main>\n\n  <footer>\n    <a href="https://triweb.com/" target="_blank" rel="noopener noreferrer" class="_copyright">powered by triweb <small><sup>&reg;</sup></small></a>\n  </footer>\n\n</div>\n')}).call(this)}.call(e),e.safe=n,e.escape=r,t.join("")}},"./src/triweb/container/ui/views/relay_welcome.html.eco":e=>{e.exports=function(e){e||(e={});var t=[],n=e.safe,r=e.escape;return e.safe=function(e){if(e&&e.ecoSafe)return e;void 0!==e&&null!=e||(e="");var t=new String(e);return t.ecoSafe=!0,t},r||(r=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e;t.push("<h3>Welcome to triweb <small><sup>&reg;</sup></small></h3>\n\n<p>You have successfully setup your relay server.</p>\n<p>To continue please point any domain name at the "),t.push((e=window.location.hostname)&&e.ecoSafe?e:void 0!==e&&null!=e?r(e):""),t.push(" IP address and add a TXT record with information which application should be installed at that domain name</p>\n")}).call(this)}.call(e),e.safe=n,e.escape=r,t.join("")}},"./src/triweb/container/ui/views sync recursive ^\\.\\/.*\\.html\\.eco$":(e,t,n)=>{var r={"./app_install_job.html.eco":"./src/triweb/container/ui/views/app_install_job.html.eco","./container_error.html.eco":"./src/triweb/container/ui/views/container_error.html.eco","./layout.html.eco":"./src/triweb/container/ui/views/layout.html.eco","./relay_welcome.html.eco":"./src/triweb/container/ui/views/relay_welcome.html.eco"};function s(e){var t=i(e);return n(t)}function i(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}s.keys=function(){return Object.keys(r)},s.resolve=i,e.exports=s,s.id="./src/triweb/container/ui/views sync recursive ^\\.\\/.*\\.html\\.eco$"},"./src/manifest.json":e=>{"use strict";e.exports=JSON.parse('{"id":"...","name":"triweb","version":"0.0.1a","base_url":"/","assets":[".../index.html",".../triweb.js"]}')}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.exports}__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var __webpack_exports__=__webpack_require__("./src/triweb.js.coffee");return __webpack_exports__})()));